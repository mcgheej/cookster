<!-- 32px = ACTIVITIES_GRID_HEADER_HEIGHT -->
<div class="grid grid-cols-1 grid-rows-1 border-r-2 divider-dark h-[32px]">
  <button
    class="self-center justify-self-center small"
    matIconButton
    [matTooltipShowDelay]="tooltipShowDelay"
    matTooltip="activities grid menu"
    [matMenuTriggerFor]="gridMenu"
    [matMenuTriggerData]="{ gridMenuData: gridMenuData() }">
    <mat-icon>more_horiz</mat-icon>
  </button>
</div>

<mat-menu #gridMenu>
  <ng-template matMenuContent let-gridMenuData="gridMenuData">
    <button mat-menu-item [matMenuTriggerFor]="pixelsPerHourMenu" [matMenuTriggerData]="{ gridMenuData: gridMenuData }">
      <mat-icon class="invisible">compress</mat-icon>
      <span>Time zoom scale</span>
    </button>
    <button mat-menu-item [matMenuTriggerFor]="laneWidthMenu">
      <mat-icon class="invisible">compress</mat-icon>
      <span>Lane width</span>
    </button>
    <mat-divider [style.margin]="0"></mat-divider>
    <button mat-menu-item [disabled]="true">
      <mat-icon>electric_bolt</mat-icon>
      <span>Actions...</span>
    </button>
    <mat-divider [style.margin]="0"></mat-divider>
    <button mat-menu-item (click)="service.openTimeWindowDialog()">
      <mat-icon>calendar_view_day</mat-icon>
      <span>Time window...</span>
    </button>
    <button mat-menu-item [disabled]="true">
      <mat-icon class="rotate-90">compare_arrows</mat-icon>
      <span>Time snap...</span>
    </button>
    <button mat-menu-item (click)="service.togglePlanEndTethered()">
      <mat-icon>{{ planEndTethered() ? 'lock_open' : 'lock_outline' }}</mat-icon>
      <span>{{ planEndTethered() ? 'Untether plan end' : 'Tether plan end' }}</span>
    </button>
    <mat-divider [style.margin]="0"></mat-divider>
    <button mat-menu-item [disabled]="true">
      <mat-icon>info_outline</mat-icon>
      <span>Properties</span>
    </button>
  </ng-template>
</mat-menu>

<mat-menu #pixelsPerHourMenu>
  <ng-template matMenuContent let-gridMenuData="gridMenuData">
    @for (option of timeZoomOptions; track $index) {
      <button mat-menu-item (click)="service.setPixelsPerHour(option.pixelsPerHour)">
        <mat-icon [class]="gridMenuData.pixelsPerHour === option.pixelsPerHour ? 'visible' : 'invisible'"
          >done</mat-icon
        >
        <span>{{ option.name }}</span>
      </button>
    }
  </ng-template>
</mat-menu>

<mat-menu #laneWidthMenu>
  <ng-template matMenuContent>
    @for (option of laneWidthOptions; track $index) {
      <button mat-menu-item (click)="service.setLaneWidths(option.value)">
        <mat-icon [class]="laneWidths() === option.value ? 'visible' : 'invisible'">done</mat-icon>
        <span>{{ option.label }}</span>
      </button>
    }
  </ng-template>
</mat-menu>
